var cvs=[],ctx=[],cv=[],img01=new Image,v01=new Image,v02=new Image,v03=new Image;img01.src="/images/shinbashi.gif",v01.src="/images/car01.gif",v02.src="/images/car02.gif",v03.src="/images/car03.gif";var ofs=[0,-40],crd=[],prev_crd=[],MAX_OBJ=11;onload=function(){cvs[0]=document.getElementById("map001"),cvs[0].getContext&&(ctx[0]=cvs[0].getContext("2d"),canvas_draw(0));for(var e=0;e<=MAX_OBJ;e++)crd[e]=[-1,-1],prev_crd[e]=[-1,-1]};var canvas_draw=function(e){ctx[0].drawImage(img01,0,0,840,740,ofs[0],ofs[1],840,740)},obj_draw=function(e,t,n,r){ctx[e].drawImage(r,0,0,40,20,ofs[0]+t-20,ofs[1]+n-10,40,20)},err_draw=function(e,t,n){ctx[e].fillStyle="rgb(255,0,0)",ctx[e].strokeStyle="rgb(0,0,0)",ctx[e].lineWidth=2,ctx[e].beginPath(),ctx[e].rect(ofs[0]+t-20,ofs[1]+n-10,40,20),ctx[e].stroke(),ctx[e].fill()},obj_els=function(e,t,n){ctx[e].drawImage(img01,t-2-20,n-2-10,44,24,ofs[0]+t-2-20,ofs[1]+n-2-10,44,24)},socket=io.connect("/scr/103");socket.on("scr103_mapie_1",function(e){var t=1;ctx[0]&&(ary=e.split(","),crd[t]=new Array(parseInt(ary[0]),parseInt(ary[1]),parseInt(ary[2])),document.getElementById("v01_state_val01").innerHTML=ary[0]+","+ary[1],document.getElementById("v01_state_val02").innerHTML=ary[2],document.getElementById("v01_state_val03").innerHTML=ary[3],document.getElementById("v01_state_val04").innerHTML=ary[4],crd[t][2]?(document.getElementById("v01_state_val02").parentNode.style.backgroundColor="red",document.getElementById("v01_state_val03").parentNode.style.backgroundColor="red"):(document.getElementById("v01_state_val02").parentNode.style.backgroundColor="",document.getElementById("v01_state_val03").parentNode.style.backgroundColor=""),ary[4].length?document.getElementById("v01_state_val04").parentNode.style.backgroundColor="gold":document.getElementById("v01_state_val04").parentNode.style.backgroundColor="",prev_crd[t][0]>0&&obj_els(0,prev_crd[t][0],prev_crd[t][1]),crd[t][2]>0?err_draw(0,crd[t][0],crd[t][1]):(ctx[0].fillStyle="rgb(0,0,0)",ctx[0].strokeStyle="rgb(255,255,255)",obj_draw(0,crd[t][0],crd[t][1],v01)),prev_crd[t]=crd[t])}),socket.on("scr103_mapie_2",function(e){var t=2;ctx[0]&&(ary=e.split(","),crd[t]=new Array(parseInt(ary[0]),parseInt(ary[1]),parseInt(ary[2])),document.getElementById("v02_state_val01").innerHTML=ary[0]+","+ary[1],document.getElementById("v02_state_val02").innerHTML=ary[2],document.getElementById("v02_state_val03").innerHTML=ary[3],document.getElementById("v02_state_val04").innerHTML=ary[4],crd[t][2]?(document.getElementById("v02_state_val02").parentNode.style.backgroundColor="red",document.getElementById("v02_state_val03").parentNode.style.backgroundColor="red"):(document.getElementById("v02_state_val02").parentNode.style.backgroundColor="",document.getElementById("v02_state_val03").parentNode.style.backgroundColor=""),ary[4].length?document.getElementById("v02_state_val04").parentNode.style.backgroundColor="gold":document.getElementById("v02_state_val04").parentNode.style.backgroundColor="",prev_crd[t][0]>0&&obj_els(0,prev_crd[t][0],prev_crd[t][1]),crd[t][2]>0?err_draw(0,crd[t][0],crd[t][1]):(ctx[0].fillStyle="rgb(0,0,255)",ctx[0].strokeStyle="rgb(255,255,0)",obj_draw(0,crd[t][0],crd[t][1],v02)),prev_crd[t]=crd[t])}),socket.on("scr103_mapie_3",function(e){var t=3;ctx[0]&&(ary=e.split(","),crd[t]=new Array(parseInt(ary[0]),parseInt(ary[1]),parseInt(ary[2])),document.getElementById("v03_state_val01").innerHTML=ary[0]+","+ary[1],document.getElementById("v03_state_val02").innerHTML=ary[2],document.getElementById("v03_state_val03").innerHTML=ary[3],document.getElementById("v03_state_val04").innerHTML=ary[4],crd[t][2]?(document.getElementById("v03_state_val02").parentNode.style.backgroundColor="red",document.getElementById("v03_state_val03").parentNode.style.backgroundColor="red"):(document.getElementById("v03_state_val02").parentNode.style.backgroundColor="",document.getElementById("v03_state_val03").parentNode.style.backgroundColor=""),ary[4].length?document.getElementById("v03_state_val04").parentNode.style.backgroundColor="gold":document.getElementById("v03_state_val04").parentNode.style.backgroundColor="",prev_crd[t][0]>0&&obj_els(0,prev_crd[t][0],prev_crd[t][1]),crd[t][2]>0?err_draw(0,crd[t][0],crd[t][1]):(ctx[0].fillStyle="rgb(0,255,0)",ctx[0].strokeStyle="rgb(255,0,255)",obj_draw(0,crd[t][0],crd[t][1],v03)),prev_crd[t]=crd[t])}),socket.on("scr103_mapie_4",function(e){var t=4;document.getElementById("debug4").innerHTML=e,ctx[0]&&(ary=e.split(","),crd[t]=new Array(parseInt(ary[0]),parseInt(ary[1]),parseInt(ary[2])),prev_crd[t][0]>0&&obj_els(0,prev_crd[t][0],prev_crd[t][1]),crd[t][2]>0?err_draw(0,crd[t][0],crd[t][1]):(ctx[0].fillStyle="rgb(0,0,255)",ctx[0].strokeStyle="rgb(255,255,0)",obj_draw(0,crd[t][0],crd[t][1])),prev_crd[t]=crd[t])}),socket.on("scr103_mapie_5",function(e){var t=5;document.getElementById("debug5").innerHTML=e,ctx[0]&&(ary=e.split(","),crd[t]=new Array(parseInt(ary[0]),parseInt(ary[1]),parseInt(ary[2])),prev_crd[t][0]>0&&obj_els(0,prev_crd[t][0],prev_crd[t][1]),crd[t][2]>0?err_draw(0,crd[t][0],crd[t][1]):(ctx[0].fillStyle="rgb(0,0,255)",ctx[0].strokeStyle="rgb(255,255,0)",obj_draw(0,crd[t][0],crd[t][1])),prev_crd[t]=crd[t])}),socket.on("scr103_mapie_6",function(e){var t=6;document.getElementById("debug6").innerHTML=e,ctx[0]&&(ary=e.split(","),crd[t]=new Array(parseInt(ary[0]),parseInt(ary[1]),parseInt(ary[2])),prev_crd[t][0]>0&&obj_els(0,prev_crd[t][0],prev_crd[t][1]),crd[t][2]>0?err_draw(0,crd[t][0],crd[t][1]):(ctx[0].fillStyle="rgb(0,0,255)",ctx[0].strokeStyle="rgb(255,255,0)",obj_draw(0,crd[t][0],crd[t][1])),prev_crd[t]=crd[t])}),socket.on("scr103_mapie_7",function(e){var t=7;document.getElementById("debug7").innerHTML=e,ctx[0]&&(ary=e.split(","),crd[t]=new Array(parseInt(ary[0]),parseInt(ary[1]),parseInt(ary[2])),prev_crd[t][0]>0&&obj_els(0,prev_crd[t][0],prev_crd[t][1]),crd[t][2]>0?err_draw(0,crd[t][0],crd[t][1]):(ctx[0].fillStyle="rgb(0,0,255)",ctx[0].strokeStyle="rgb(255,255,0)",obj_draw(0,crd[t][0],crd[t][1])),prev_crd[t]=crd[t])}),socket.on("scr103_mapie_8",function(e){var t=8;document.getElementById("debug8").innerHTML=e,ctx[0]&&(ary=e.split(","),crd[t]=new Array(parseInt(ary[0]),parseInt(ary[1]),parseInt(ary[2])),prev_crd[t][0]>0&&obj_els(0,prev_crd[t][0],prev_crd[t][1]),crd[t][2]>0?err_draw(0,crd[t][0],crd[t][1]):(ctx[0].fillStyle="rgb(0,0,255)",ctx[0].strokeStyle="rgb(255,255,0)",obj_draw(0,crd[t][0],crd[t][1])),prev_crd[t]=crd[t])}),socket.on("scr103_mapie_9",function(e){var t=9;document.getElementById("debug9").innerHTML=e,ctx[0]&&(ary=e.split(","),crd[t]=new Array(parseInt(ary[0]),parseInt(ary[1]),parseInt(ary[2])),prev_crd[t][0]>0&&obj_els(0,prev_crd[t][0],prev_crd[t][1]),crd[t][2]>0?err_draw(0,crd[t][0],crd[t][1]):(ctx[0].fillStyle="rgb(0,0,255)",ctx[0].strokeStyle="rgb(255,255,0)",obj_draw(0,crd[t][0],crd[t][1])),prev_crd[t]=crd[t])}),socket.on("scr103_mapie_10",function(e){var t=10;document.getElementById("debug10").innerHTML=e,ctx[0]&&(ary=e.split(","),crd[t]=new Array(parseInt(ary[0]),parseInt(ary[1]),parseInt(ary[2])),prev_crd[t][0]>0&&obj_els(0,prev_crd[t][0],prev_crd[t][1]),crd[t][2]>0?err_draw(0,crd[t][0],crd[t][1]):(ctx[0].fillStyle="rgb(0,0,255)",ctx[0].strokeStyle="rgb(255,255,0)",obj_draw(0,crd[t][0],crd[t][1])),prev_crd[t]=crd[t])});