var drawbar=[[],[]],cvs=[],ctx=[],cv=[],rdy=[0,0],data=[{}];data=[{w:0,h:0,inr_w:600,inr_h:150,top_sp:25,bottom_sp:25,right_sp:150,left_sp:50,seq:[{min:10,max:40,span:10,onevalPx:0}],base:{min:0,max:100,span:10,onevalPx:0},style:[{stroke:"rgb(0, 0, 0)",fill:"rgb(255, 0, 0)"}],zzz:0},{w:0,h:0,inr_w:600,inr_h:150,top_sp:25,bottom_sp:25,right_sp:150,left_sp:50,seq:[{min:0,max:100,span:10,onevalPx:0}],base:{min:0,max:100,span:10,onevalPx:0},style:[{stroke:"rgb(0, 0, 0)",fill:"rgb(0, 0, 255)"}],zzz:0}],onload=function(){cvs[0]=document.getElementById("glp001"),cvs[1]=document.getElementById("glp002"),cvs[0].getContext&&(ctx[0]=cvs[0].getContext("2d"),canvas_draw(0)),cvs[1].getContext&&(ctx[1]=cvs[1].getContext("2d"),canvas_draw(1))};var canvas_draw=function(e){cv[e]=ctx[e].canvas,data[e].w=cv[e].width,data[e].h=cv[e].height,ctx[e].lineWidth=2,ctx[e].strokeStyle="rgb(0, 0, 0)",ctx[e].beginPath(),ctx[e].moveTo(data[e].left_sp,data[e].top_sp),ctx[e].lineTo(data[e].left_sp,data[e].top_sp+data[e].inr_h),ctx[e].lineTo(data[e].left_sp+data[e].inr_w,data[e].top_sp+data[e].inr_h),ctx[e].lineTo(data[e].left_sp+data[e].inr_w,data[e].top_sp),ctx[e].closePath(),ctx[e].stroke();for(var t=0,n=data[e].seq.length;t<n;t++){ctx[e].font="bold 12px 'ＭＳ 明朝'",ctx[e].textBaseline="middle",t==1?(ctx[e].textAlign="end",ctx[e].fillText(data[e].seq[t].min,data[e].left_sp-5,data[e].top_sp+data[e].inr_h),ctx[e].fillText(data[e].seq[t].max,data[e].left_sp-5,data[e].top_sp)):(ctx[e].textAlign="start",ctx[e].fillText(data[e].seq[t].min,data[e].left_sp+data[e].inr_w+5+t*20,data[e].top_sp+data[e].inr_h),ctx[e].fillText(data[e].seq[t].max,data[e].left_sp+data[e].inr_w+5+t*20,data[e].top_sp));var r=data[e].seq[t].min,i=data[e].seq[t].max;data[e].seq[t].onevalPx=data[e].inr_h/(i-r),ctx[e].font="normal 10px 'ＭＳ ゴシック'",ctx[e].textBaseline="middle";for(var s=r+data[e].seq[t].span;s<i;s+=data[e].seq[t].span)t==1?ctx[e].fillText(s,data[e].left_sp-5,data[e].top_sp+data[e].inr_h-(s-r)*data[e].seq[t].onevalPx):ctx[e].fillText(s,data[e].left_sp+data[e].inr_w+5+t*20,data[e].top_sp+data[e].inr_h-(s-r)*data[e].seq[t].onevalPx)}ctx[e].font="bold 12px 'ＭＳ 明朝'",ctx[e].textBaseline="top",ctx[e].textAlign="center",ctx[e].fillText(data[e].base.min,data[e].left_sp+data[e].inr_w,data[e].top_sp+data[e].inr_h+3),ctx[e].fillText(data[e].base.max,data[e].left_sp,data[e].top_sp+data[e].inr_h+3);var o=data[e].base.min,u=data[e].base.max;data[e].base.onevalPx=data[e].inr_w/(u-o),ctx[e].font="normal 10px 'ＭＳ ゴシック'";for(var s=o+data[e].base.span;s<u;s+=data[e].base.span)ctx[e].fillText(s,data[e].left_sp+data[e].inr_w-(s-o)*data[e].base.onevalPx,data[e].top_sp+data[e].inr_h+3);for(var t=0,i=data[e].base.max;t<i;t++){var a={x:data[e].left_sp+data[e].inr_w-data[e].base.onevalPx*(t+1),y:data[e].top_sp+data[e].inr_h,w:data[e].base.onevalPx,h:0};drawbar[e].push(a)}rdy[e]=1},bar_draw=function(e,t,n){if(n<0||n>=data[t].seq.length)return;if(ctx[t]&&rdy[t]){ctx[t].strokeStyle=data[t].style[n].stroke,ctx[t].fillStyle=data[t].style[n].fill,drawbar[t][0].y=data[t].top_sp+data[t].inr_h-(parseInt(e)-data[t].seq[n].min)*data[t].seq[n].onevalPx,drawbar[t][0].h=(parseInt(e)-data[t].seq[n].min)*data[t].seq[n].onevalPx;var r=data[t].top_sp,i=data[t].inr_h;for(var s=0,o=data[t].base.max;s<o;s++)ctx[t].clearRect(drawbar[t][s].x,r,drawbar[t][s].w,i),ctx[t].fillRect(drawbar[t][s].x,drawbar[t][s].y,drawbar[t][s].w,drawbar[t][s].h),ctx[t].strokeRect(drawbar[t][s].x,drawbar[t][s].y,drawbar[t][s].w,drawbar[t][s].h);for(var s=data[t].base.max-1,u=0;s>=u;s--)s===0?(drawbar[t][s].y=data[t].top_sp+data[t].inr_h,drawbar[t][s].h=0):(drawbar[t][s].y=drawbar[t][s-1].y,drawbar[t][s].h=drawbar[t][s-1].h)}},socket=io.connect("/scr/104");socket.on("scr104_tmplog",function(e){document.getElementById("tmplog").innerHTML=e,bar_draw(e,0,0)}),socket.on("scr104_worklog",function(e){document.getElementById("worklog").innerHTML=e,bar_draw(e,1,0)});