function debugXp(e){$("#debugtxt").html($("#debugtxt").html()+e+"<br>")}function test1(e,t){setTimeout(function(){parseInt($('[panel="pn001"]').css("top"))+PANELSIZE.width>=YMAX*PANELSIZE.width?e="-="+PANELSIZE.width+"px":parseInt($('[panel="pn001"]').css("top"))<=0&&(e="+="+PANELSIZE.width+"px"),$('div[panel="pn001"]').animate({top:e,left:t},{duration:"1000",easing:"swing",complete:function(){}}),test1(e,t)},2e3)}var socket=io.connect("/error");sockEventShowError(socket);var socket904=io.connect("/scr/904");socket904.on("message_bar",function(e){err=document.getElementById("mesg_bar"),err.className="mesg_bar "+e.color,err.innerText=e.mesg});var XMAX=0,YMAX=0,LIMWIDTH=0,LIMHEIGHT=0,PANELSIZE={};socket904.on("zaika",function(e){var t='div[panel="'+e.id+'"] p';e.act=="dead"&&$(t).fadeOut("slow",function(){$(this).removeClass("zaika")}),e.act=="born"&&$(t).fadeIn("slow",function(){$(this).addClass("zaika")})}),socket904.on("move",function(e){var t="+=0px",n="+=0px",r='div[panel="'+e.id+'"]';e.act=="up"&&(t="-="+PANELSIZE.width+"px"),e.act=="down"&&(t="+="+PANELSIZE.width+"px"),e.act=="left"&&(n="-="+PANELSIZE.width+"px"),e.act=="right"&&(n="+="+PANELSIZE.width+"px"),$(r).animate({top:t,left:n},{duration:"1000",easing:"swing",complete:function(){}})}),$(function(){XMAX=$('input[name="xMax"]').get(0).value,YMAX=$('input[name="yMax"]').get(0).value,LIMWIDTH=parseInt($("div.puzzle").css("width")),LIMHEIGHT=parseInt($("div.puzzle").css("height")),$("#main_body div.caption").html($("#main_body div.caption").html()+" "+XMAX+" x "+YMAX),PANELSIZE.type=$('input[name="panelsize"]').get(0).value;switch(PANELSIZE.type){case"S":PANELSIZE.width=50;break;case"M":PANELSIZE.width=100;break;case"L":PANELSIZE.width=200;break;case"XL":PANELSIZE.width=300;break;default:PANELSIZE.type="M",PANELSIZE.width=100}if(XMAX*PANELSIZE.width>LIMWIDTH){$("#mesg_bar").html("描画エラー"),$("#mesg_bar").addClass("operationPanel_fatal");return}if(YMAX*PANELSIZE.width>LIMHEIGHT){$("#mesg_bar").html("描画エラー"),$("#mesg_bar").addClass("operationPanel_fatal");return}for(var e=0;e<XMAX;e++)for(var t=0;t<YMAX;t++){var n=$("input[x="+e+"][y="+t+"]").get(0);if(n){debugXp(n.id+":"+n.name+":"+n.value);var r="";n.value=="1"?r='<p class="zaika"></p>':r="<p></p>",$("#main_body div.puzzle").html($("#main_body div.puzzle").html()+'<div panel="'+n.id+'" type="'+n.name+'" class="'+n.name+'">'+r+"</div>"),$("#main_body div.puzzle p:last").css({width:PANELSIZE.width/2+"px",height:PANELSIZE.width/2+"px","margin-left":PANELSIZE.width/4-2+"px","margin-top":PANELSIZE.width/4-2+"px"}),$("#main_body div.puzzle div:last").css({width:PANELSIZE.width-3+"px",height:PANELSIZE.width-3+"px",position:"absolute",left:e*PANELSIZE.width+"px",top:t*PANELSIZE.width+"px",border:"1px none black"})}}});